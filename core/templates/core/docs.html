<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Storefront API Documentation</title>
    
    <!-- Using the same Bootstrap 5 link -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
    <style>
        body {
            background-color: #f4f7f9;
            color: #343a40;
            padding-top: 30px;
            padding-bottom: 50px;
        }
        .doc-header {
            background-color: #007bff;
            color: #ffffff;
            padding: 30px 0;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.3);
        }
        .api-section {
            background-color: #ffffff;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 25px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        .endpoint-url {
            font-family: monospace;
            background-color: #e9ecef;
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
            margin-top: 5px;
            font-size: 0.95rem;
        }
        .http-method {
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 3px;
            color: white;
            margin-right: 10px;
            min-width: 60px; /* Uniform width for methods */
            display: inline-block;
            text-align: center;
        }
        .method-GET { background-color: #28a745; }
        .method-POST { background-color: #ffc107; color: #343a40; }
        .method-PUT { background-color: #007bff; }
        .method-PATCH { background-color: #17a2b8; } /* Teal for PATCH */
        .method-DELETE { background-color: #dc3545; }
        
        .code-block {
            background-color: #212529;
            color: #e83e8c;
            padding: 15px;
            border-radius: 6px;
            margin-top: 10px;
            overflow-x: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>

<div class="container">
    
    <header class="doc-header text-center">
        <h1>Storefront API Reference</h1>
        <p class="lead">Complete documentation for Storefront API V1.0</p>
    </header>

    <div class="row">
        <div class="col-lg-12">
            
            <!-- Introduction & Authentication -->
            <div class="api-section">
                <h2>Introduction & Authentication</h2>
                <p>
                    The Storefront API provides programmatic access to our resources via JSON over HTTPS.
                    The base URL for all endpoints is implicitly <code>/</code> (e.g., <code>/store/products/</code>).
                </p>
                <h4 class="mt-4">Authentication</h4>
                <p>
                    Endpoints requiring data modification (POST, PUT, PATCH, DELETE) require a JSON Web Token (JWT) provided in the <code>Authorization: JWT &lt;token&gt;</code> header.
                    Administrative endpoints require Staff/Admin privileges.
                </p>
                <div class="p-3 bg-light rounded">
                    <span class="http-method method-POST">POST</span> 
                    <span class="endpoint-url">/auth/jwt/create/</span>
                    <br><small class="text-muted">Use this endpoint to exchange username and password for a JWT.</small>
                </div>
            </div>
            
            <!-- PRODUCT RESOURCE -->
            <div class="api-section" id="products">
                <h2 class="text-primary">Product Resources</h2>
                <p class="text-muted">Manages product inventory, pricing, and details.</p>
                
                <hr>

                <!-- GET List & Create -->
                <h4 class="mt-3">List Products & Create (CRUD List)</h4>
                
                <p>
                    <span class="http-method method-GET">GET</span>
                    <span class="endpoint-url">/store/products/</span>
                    <br><small class="text-muted">Retrieves a paginated list of all products. <br><strong>Query Params:</strong> <code>collection_id</code>, <code>ordering</code> (e.g., <code>-unit_price</code>).</small>
                </p>
                <p>
                    <span class="http-method method-POST">POST</span>
                    <span class="endpoint-url">/store/products/</span>
                    <br><small class="text-muted">Creates a new product. (Staff/Admin Required)</small>
                </p>

                <!-- GET Detail, Update, Delete -->
                <h4 class="mt-4">Detail, Update, Delete (CRUD Detail)</h4>

                <p>
                    <span class="http-method method-GET">GET</span>
                    <span class="endpoint-url">/store/products/{id}/</span>
                    <br><small class="text-muted">Retrieve details for a single product.</small>
                </p>
                <p>
                    <span class="http-method method-PUT">PUT</span>
                    <span class="endpoint-url">/store/products/{id}/</span>
                    <br><small class="text-muted">Performs a full update on an existing product. (Staff/Admin Required)</small>
                </p>
                <p>
                    <span class="http-method method-PATCH">PATCH</span>
                    <span class="endpoint-url">/store/products/{id}/</span>
                    <br><small class="text-muted">Performs a partial update (e.g., update price only). (Staff/Admin Required)</small>
                </p>
                <p>
                    <span class="http-method method-DELETE">DELETE</span>
                    <span class="endpoint-url">/store/products/{id}/</span>
                    <br><small class="text-muted">Deletes a product. (Staff/Admin Required)</small>
                </p>

                <h4 class="mt-5">Product JSON Example (POST/PUT)</h4>
                <pre class="code-block">
{
  "title": "Silk Scarf, Azure",
  "description": "Luxurious lightweight scarf.",
  "unit_price": 49.99,
  "inventory": 150,
  "collection": 5
}</pre>
            </div>
            
            <!-- COLLECTION RESOURCE -->
            <div class="api-section" id="collections">
                <h2 class="text-success">Collection Resources</h2>
                <p class="text-muted">Manages logical grouping of products (categories).</p>

                <hr>

                <!-- GET List & Create -->
                <h4 class="mt-3">List Collections & Create</h4>
                
                <p>
                    <span class="http-method method-GET">GET</span>
                    <span class="endpoint-url">/store/collections/</span>
                    <br><small class="text-muted">Lists all collections, showing <code>products_count</code> for each.</small>
                </p>
                <p>
                    <span class="http-method method-POST">POST</span>
                    <span class="endpoint-url">/store/collections/</span>
                    <br><small class="text-muted">Creates a new collection. (Staff/Admin Required)</small>
                </p>

                <!-- GET Detail, Update, Delete -->
                <h4 class="mt-4">Detail & Delete</h4>

                <p>
                    <span class="http-method method-GET">GET</span>
                    <span class="endpoint-url">/store/collections/{id}/</span>
                    <br><small class="text-muted">Retrieve details for a single collection.</small>
                </p>
                <p>
                    <span class="http-method method-DELETE">DELETE</span>
                    <span class="endpoint-url">/store/collections/{id}/</span>
                    <br><small class="text-muted">Deletes a collection. Will fail if products are linked due to database protection. (Staff/Admin Required)</small>
                </p>
                
                <h4 class="mt-5">Collection JSON Example (POST)</h4>
                <pre class="code-block">
{
  "title": "New Season Arrivals"
}</pre>
            </div>

            <!-- CART & ORDER RESOURCE -->
            <div class="api-section" id="cart">
                <h2 class="text-warning">Cart and Order Management</h2>
                <p class="text-muted">Handles shopping cart state and order placement.</p>

                <hr>

                <h4 class="mt-3">Carts (Anonymous Access)</h4>
                <p>
                    <span class="http-method method-POST">POST</span>
                    <span class="endpoint-url">/store/carts/</span>
                    <br><small class="text-muted">Creates a new shopping cart and returns its UUID.</small>
                </p>
                <p>
                    <span class="http-method method-POST">POST</span>
                    <span class="endpoint-url">/store/carts/{cart_pk}/items/</span>
                    <br><small class="text-muted">Adds an item to the specified cart. Requires <code>product_id</code> and <code>quantity</code> in the body.</small>
                </p>

                <h4 class="mt-4">Orders (Authenticated)</h4>
                 <p>
                    <span class="http-method method-POST">POST</span>
                    <span class="endpoint-url">/store/orders/</span>
                    <br><small class="text-muted">Creates a new order from a shopping cart. (Authenticated User Required)</small>
                </p>

                <h4 class="mt-5">Cart Item JSON Example (POST)</h4>
                <pre class="code-block">
{
  "product_id": 3,
  "quantity": 2
}</pre>
            </div>
            
            <!-- Footer Link -->
            <div class="mt-4 text-center">
                <a href="{% url 'api-home' %}" class="btn btn-secondary">← Back to Home</a>
            </div>

        </div>
    </div>

</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
